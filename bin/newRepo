#!/bin/bash

if [[ $USER == git ]];
then
    repo=$(echo "$repo" | sed "s/\.git//")

    mkdir "$repo"
    if [ $? -ne 0 ]; then
        echo "Error creating directoy \"$repo\""
        exit 1
    fi

    chmod 700 -R "$repo"
    if [ $? -ne 0 ]; then
        echo "Error with permissions 700 to directoy \"$repo\""
        exit 2
    fi

    ln -rs "$repo" "$repo.git"
    if [ $? -ne 0 ]; then
        echo "Error linking directoy \"$repo\""
        exit 3
    fi

    cd "$repo"
    if [ $? -ne 0 ]; then
        echo "Error changing to directoy \"$repo\""
        exit 4
    fi

    git init --bare
    echo "ref: refs/heads/main" > HEAD
else
    ssh git@$1 "./newRepo $2"
fi

